/* --- 调整详情页布局：将 简介(Content) 和 详情(Group) 设为垂直排列 --- */

/* 1. 将它们的父容器 .detailSection 设为 Flex 布局，并指定为垂直方向 */
.detailSection {
  display: flex;
  flex-direction: column; /* 关键：强制所有子元素垂直堆叠 */
}

/* 2. 为 简介(Content) 指定顺序为 1 */
.detailSectionContent {
  order: 1;
}

/* 3. 为 详情(Group) 指定顺序为 2 (这样它就会被“移动”到简介的尾部) */
.itemDetailsGroup {
  order: 2;
}


/* --- Episode Grid Layout for Jellyfin 10.11.0 --- */

/* Updated main container selector for the grid */
#listChildrenCollapsible .itemsContainer.vertical-list {
  display: grid;
  grid-template-columns: repeat(4, 1fr); /* Default to 4 columns */
  gap: 1.5em; /* Add some gap between items */
}

/* Responsive adjustments for column count */
@media all and (max-width: 2000px) {
  #listChildrenCollapsible .itemsContainer.vertical-list {
    grid-template-columns: repeat(3, 1fr); /* 3 columns for medium screens */
  }
}

@media all and (max-width: 1000px) {
  #listChildrenCollapsible .itemsContainer.vertical-list {
    grid-template-columns: repeat(2, 1fr); /* 2 columns for smaller screens */
  }
}

/* Mobile specific: Force 1 column and adjust padding/margins */
.layout-mobile #listChildrenCollapsible .itemsContainer.vertical-list {
  grid-template-columns: 1fr; /* 1 column on mobile */
  padding-right: 0; /* Remove potential right padding */
  gap: 1em;
}

/* Individual item styling */
#itemDetailPage .listItem {
  position: relative;
  height: fit-content; /* Let content determine height */
  overflow: hidden;
  margin-bottom: 0; /* Grid gap handles spacing */
  border-radius: var(--rounding, 8px); /* Use theme rounding or default */
  padding: 0; /* Remove default padding */
  background-color: rgba(var(--background-color-rgb, 0, 0, 0), 0.2); /* Slight background tint */
}

#itemDetailPage .listItem-content {
  border-radius: var(--rounding, 8px);
  overflow: hidden;
  transition: background 0.15s ease-in-out;
  display: flex; /* Use flex for column layout */
  flex-direction: column; /* Stack image and text vertically */
  height: 100%; /* Fill the grid item */
  background: none; /* Reset background, handled by .listItem now */
}

/* Episode Image */
.listItemImage.listItemImage-large {
  width: 100%;
  margin: 0;
  height: auto; /* Let aspect ratio determine height */
  aspect-ratio: 16 / 9; /* Common video aspect ratio */
  position: relative; /* Needed for overlay buttons */
}

/* Episode Text Body */
.listItemBody.itemAction {
  padding: 0.75em; /* Add padding around text */
  z-index: 1;
}

/* Episode Title */
.listItemBodyText:first-of-type { /* Target the title specifically */
    font-weight: bold;
    margin-bottom: 0.25em;
}

/* Episode Overview */
.secondary.listItem-overview.listItemBodyText {
  font-size: 0.9em !important; /* Slightly smaller font */
  height: auto; /* Remove fixed height */
  margin: 0.5em 0 0 0;
  overflow: hidden;
  display: -webkit-box;
  -webkit-line-clamp: 3; /* Limit to 3 lines */
  -webkit-box-orient: vertical;
  text-align: justify;
}

/* Hide the bottom overview that duplicates info */
.listItem-bottomoverview.secondary {
    display: none;
}

/* --- Mobile Specific Overrides --- */

.layout-mobile #itemDetailPage .listItemImage.listItemImage-large {
  aspect-ratio: auto; /* Let image decide on mobile? Or keep 16/9? Test needed. */
}

/* Adjust button positioning on mobile if needed */
.layout-mobile .listViewUserDataButtons {
  position: absolute;
  top: 0.5em;
  right: 0.5em;
  background-color: rgba(0, 0, 0, 0.5); /* Add background for visibility */
  border-radius: 5px;
  padding: 2px;
}

.layout-mobile .listItemButton {
  padding: 0 0.3em !important;
  color: white; /* Ensure buttons are visible */
}

.layout-mobile .listItemImageButton {
    /* Play button in center */
   position: absolute;
   top: 50%;
   left: 50%;
   transform: translate(-50%, -50%);
   font-size: 2.5em !important;
   background-color: rgba(0,0,0,0.6);
   border-radius: 50%;
   width: 1.5em;
   height: 1.5em;
   line-height: 1.5em; /* Center icon vertically */
}

.layout-mobile .listItemIndicators {
  /* Position indicators top right */
  top: 0.5em;
  right: 0.5em;
  z-index: 2; /* Above buttons */
}

.layout-mobile .playedIndicator {
  width: 1.8em;
  height: 1.8em;
  font-size: 1rem;
}

.layout-mobile .listItem .playedIndicator {
  background: rgba(var(--accent-rgb, 0, 160, 0), 0.8) !important; /* Use accent color */
  color: white;
}

/* Remove hover glow effect if it came from the other theme */
.card-hoverable:hover .cardBox,
.cardOverlayContainer:hover ~ .cardBox {
    box-shadow: none;
}
